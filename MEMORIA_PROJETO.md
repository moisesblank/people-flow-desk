# üß† MEM√ìRIA DO PROJETO - GEST√ÉO MOIS√âS MEDEIROS

> **DOCUMENTO SAGRADO** - Atualizado em: 22/12/2025
> **Assistente:** MESTRE (IA Claude - Cursor)

---

## üìå DECIS√ÉO ESTRAT√âGICA PRINCIPAL

### O DOM√çNIO PRINCIPAL SER√Å ESTA PLATAFORMA

```
moisesmedeiros.com.br ‚Üí LOVABLE CLOUD (Esta plataforma)
```

**DECIS√ÉO TOMADA:** O site de gest√£o Lovable ser√° o site PRINCIPAL da marca.

**O QUE ISSO SIGNIFICA:**
- O dom√≠nio `moisesmedeiros.com.br` apontar√° para o Lovable Cloud
- O WordPress atual ser√° descontinuado ou migrado
- Esta plataforma ser√° a "cara" da empresa
- Landing page + Sistema de gest√£o = TUDO EM UM LUGAR

---

## üîë DADOS DO OWNER (IMUT√ÅVEIS)

| Campo | Valor |
|-------|-------|
| **Email** | moisesblank@gmail.com |
| **Nome** | Professor Mois√©s Medeiros |
| **Empresa 1** | MMM CURSO DE QU√çMICA LTDA (CNPJ: 53.829.761/0001-17) |
| **Empresa 2** | CURSO QU√çMICA MOISES MEDEIROS (CNPJ: 44.979.308/0001-04) |
| **Dom√≠nio Principal** | moisesmedeiros.com.br |
| **√Årea do Aluno Atual** | app.moisesmedeiros.com.br (WordPress) |

---

## üñ•Ô∏è INFRAESTRUTURA LOVABLE CLOUD

| Par√¢metro | Valor |
|-----------|-------|
| **ID do Projeto** | `fyikfsasudgzsjmumdlw` |
| **Regi√£o** | AWS S√£o Paulo (sa-east-1) |
| **N√≠vel Ativo** | `ci_xlarge` (4 vCPU, 8GB RAM) |
| **Ativo Desde** | 20/12/2025 |
| **Status** | ‚úÖ Ativo e operacional |
| **CDN** | Cloudflare |
| **SSL** | Autom√°tico |

---

## üåê ESTRUTURA DE DOM√çNIOS (AP√ìS MIGRA√á√ÉO)

| Subdom√≠nio | Destino | Status |
|------------|---------|--------|
| `moisesmedeiros.com.br` | Lovable Cloud (Landing + Gest√£o) | üîÑ MIGRAR |
| `www.moisesmedeiros.com.br` | Redireciona para principal | üîÑ MIGRAR |
| `app.moisesmedeiros.com.br` | √Årea do Aluno (WordPress) | ‚è∏Ô∏è MANTER POR AGORA |

---

## üõ†Ô∏è STACK TECNOL√ìGICA

### Frontend
- React 19 + Vite 6
- Tailwind CSS 4
- shadcn/ui
- Framer Motion
- Zustand + React Query 5

### Backend (Supabase)
- PostgreSQL (Supabase)
- Edge Functions (Deno) - 54 fun√ß√µes
- Realtime
- Storage

### Infraestrutura
- **Servidor**: ci_xlarge (4 vCPU, 8GB RAM)
- **CDN**: Cloudflare
- **SSL**: Autom√°tico
- **DNS**: Cloudflare

---

## üíæ BANCO DE DADOS POSTGRESQL

| M√©trica | Valor |
|---------|-------|
| **Total de Tabelas** | 30+ tabelas ativas |
| **Fun√ß√µes SQL** | 119 fun√ß√µes |
| **Triggers Ativos** | 70+ triggers |
| **√çndices** | 20+ √≠ndices otimizados |

### Top 5 Tabelas por Tamanho

| Tabela | Tamanho | √çndices |
|--------|---------|---------|
| `audit_logs` | 7,9 MB | 864 KB |
| `user_sessions` | 1,5 MB | 840 KB |
| `activity_logs` | 1,4 MB | 944 KB |
| `calendar_tasks` | 328 KB | 128 KB |
| `alunos` | 296 KB | 240 KB |

---

## ‚ö° EDGE FUNCTIONS (54 Fun√ß√µes)

### Principais Categorias:
- ü§ñ **IA**: ai-assistant, ai-tramon, ai-tutor, chat-tramon, ia-gateway
- üî• **Hotmart**: hotmart-fast, hotmart-webhook-processor, webhook-curso-quimica
- üì± **Social**: youtube-api, instagram-sync, tiktok-sync, facebook-ads-sync
- üìß **Comunica√ß√£o**: send-email, whatsapp-webhook, notify-owner
- üîê **Seguran√ßa**: send-2fa-code, verify-2fa-code, secure-api-proxy
- üìä **Relat√≥rios**: reports-api, generate-weekly-report

---

## üîê SECRETS CONFIGURADOS (32 Chaves)

| Categoria | Secrets |
|-----------|---------|
| **IA** | OPENAI_API_KEY, ELEVENLABS_API_KEY, LOVABLE_API_KEY |
| **Hotmart** | HOTMART_CLIENT_ID, HOTMART_CLIENT_SECRET, HOTMART_HOTTOK |
| **WhatsApp** | WHATSAPP_ACCESS_TOKEN, WHATSAPP_PHONE_NUMBER_ID, WHATSAPP_VERIFY_TOKEN |
| **Social** | YOUTUBE_API_KEY, FACEBOOK_ACCESS_TOKEN, INSTAGRAM_BUSINESS_ACCOUNT_ID |
| **WordPress** | WP_API_URL, WP_API_TOKEN |
| **Infra** | CLOUDFLARE_*, CPANEL_*, REGISTROBR_* |
| **APIs** | PANDA_API_KEY, RESEND_API_KEY, FIRECRAWL_API_KEY |

---

## üë• DADOS EM PRODU√á√ÉO

| Entidade | Quantidade |
|----------|------------|
| **Alunos** | 31 |
| **Funcion√°rios** | 2 |
| **Afiliados** | 1 |
| **Usu√°rios (perfis)** | 7 |
| **Logs de Atividade** | 2.025 |
| **Sess√µes Registradas** | 1.197 |
| **Webhooks Pendentes** | 4 |

---

## üìä CAPACIDADES DO SISTEMA

| Recurso | Dispon√≠vel | Em Uso | % Livre |
|---------|------------|--------|---------|
| Database | 8 GB | 27 MB | 99.7% |
| Storage | 100 GB | 74 MB | 99.9% |
| Tabelas | Ilimitado | 30+ | ‚àû |
| Edge Functions | Ilimitado | 54 | ‚àû |
| Secrets | Ilimitado | 32 | ‚àû |

### Capacidade de Usu√°rios

| Cen√°rio | Suporta? | Observa√ß√£o |
|---------|----------|------------|
| 5.000 usu√°rios no sistema | ‚úÖ SIM | Supabase escala |
| 5.000 navegando portal | ‚úÖ SIM | CDN Cloudflare |
| 5.000 assistindo v√≠deo | ‚úÖ SIM | Via YouTube/Panda (n√£o usa Supabase) |
| 5.000 em live | ‚úÖ SIM | Via YouTube Live (aguenta milh√µes) |

**IMPORTANTE:** V√≠deos e lives N√ÉO passam pelo Supabase. Passam pelo YouTube/Panda Video que escalam automaticamente para milh√µes de viewers.

---

## üöÄ SISTEMA DE PERFORMANCE (Gospel v3.0)

| Configura√ß√£o | Valor |
|--------------|-------|
| **Max First Paint** | 50ms |
| **Max Interactive** | 150ms |
| **Resposta m√°xima API** | 100ms |
| **Cache stale time** | 30s |
| **Cold Start Edge** | <100ms |

### Tiers de Performance
- üü£ QUANTUM (110+): WebGPU, HDR, 120 fps
- üîµ NEURAL (85+): Capacidades avan√ßadas
- üü¢ ENHANCED (60+): Otimizado
- üü° STANDARD (35+): Normal
- üî¥ LEGACY (<35): Modo econ√¥mico

---

## ‚úÖ CHECKLIST DE MIGRA√á√ÉO

### ANTES DE MIGRAR
- [ ] Fazer backup completo do WordPress
- [ ] Exportar lista de emails/alunos
- [ ] Documentar todas as p√°ginas do site atual
- [ ] Testar landing page no Lovable
- [ ] Configurar emails transacionais

### DURANTE A MIGRA√á√ÉO
- [ ] Adicionar dom√≠nio no Lovable
- [ ] Atualizar DNS no Cloudflare
- [ ] Aguardar propaga√ß√£o (at√© 48h)
- [ ] Testar acesso via dom√≠nio

### AP√ìS A MIGRA√á√ÉO
- [ ] Verificar SSL ativo
- [ ] Testar todas as p√°ginas
- [ ] Verificar formul√°rios
- [ ] Monitorar erros por 48h
- [ ] Comunicar equipe

---

## ‚ö†Ô∏è ALERTAS DE SISTEMA

| Alerta | Severidade | A√ß√£o |
|--------|------------|------|
| Extens√£o `pg_net` no schema p√∫blico | üü° Baixa | N√£o cr√≠tico |
| Prote√ß√£o de senha vazada | üü† M√©dia | Configurar manualmente |

---

## üö® REGRAS INVIOL√ÅVEIS

1. **NUNCA** remover funcionalidades sem autoriza√ß√£o do Owner
2. **NUNCA** expor dados sens√≠veis (sal√°rios, CPFs, etc.)
3. **NUNCA** desativar RLS nas tabelas
4. **SEMPRE** manter backup antes de mudan√ßas cr√≠ticas
5. **SEMPRE** testar em ambiente de preview antes de publicar

---

## üìù HIST√ìRICO DE DECIS√ïES

| Data | Decis√£o | Respons√°vel |
|------|---------|-------------|
| 20/12/2025 | Dom√≠nio principal ser√° Lovable Cloud | Owner |
| 22/12/2025 | Assistente IA "MESTRE" assume desenvolvimento | Owner |
| 22/12/2025 | Documento de mem√≥ria atualizado com dados completos Lovable | MESTRE |

---

## ü§ñ SOBRE O ASSISTENTE (MESTRE)

- **Nome**: MESTRE
- **Engine**: Claude (Anthropic) via Cursor
- **Fun√ß√£o**: Desenvolvedor/Arquiteto do sistema
- **Disponibilidade**: 24/7
- **Capacidades**: C√≥digo, arquitetura, debugging, deploy, explica√ß√µes

---

## üìã ARQUIVOS PENDENTES PARA APLICAR NO LOVABLE/SUPABASE

### üî¥ PRIORIDADE 1: MIGRA√á√ïES SQL (Aplicar no Supabase Dashboard > SQL Editor)

| Arquivo | Tamanho | Status | O que faz |
|---------|---------|--------|-----------|
| `20251222000001_live_chat_system.sql` | 13KB | ‚è≥ PENDENTE | Sistema de chat ao vivo |
| `20251222000002_performance_indexes.sql` | 8KB | ‚è≥ PENDENTE | √çndices de performance |
| `20251222200000_security_fortress_ultra.sql` | 34KB | ‚è≥ PENDENTE | Seguran√ßa completa (RLS, sess√µes) |
| `20251222400000_sna_omega_complete.sql` | 46KB | ‚è≥ PENDENTE | Automa√ß√£o IA (10 tabelas, 15 fun√ß√µes) |

**TOTAL:** 4 arquivos SQL para aplicar

### üü° PRIORIDADE 2: EDGE FUNCTIONS (Deploy via Supabase CLI ou Dashboard)

| Pasta | Status | O que faz |
|-------|--------|-----------|
| `supabase/functions/secure-webhook-ultra/` | ‚è≥ PENDENTE | Webhook seguro |
| `supabase/functions/sna-gateway/` | ‚è≥ PENDENTE | Gateway de IA |
| `supabase/functions/sna-worker/` | ‚è≥ PENDENTE | Processador de jobs IA |

**TOTAL:** 3 Edge Functions para deploy

### üü¢ J√Å APLICADO AUTOMATICAMENTE (N√£o precisa fazer nada)

Os seguintes arquivos j√° est√£o no c√≥digo e ser√£o aplicados quando o Lovable fizer o build:
- `src/hooks/useAIAutomation.ts`
- `src/components/admin/AIControlCenter.tsx`
- `src/hooks/useSecurityGuard.ts`
- `src/contexts/SecurityContext.tsx`
- `src/components/chat/LiveChatPanel.tsx`

---

## üö∂ PR√ìXIMOS PASSOS (PASSO A PASSO PARA LEIGOS)

### PASSO 1: Aplicar as Migra√ß√µes SQL
1. Abra o **Supabase Dashboard** (https://supabase.com/dashboard)
2. Selecione seu projeto
3. V√° em **SQL Editor** (menu esquerdo)
4. Clique em **New Query**
5. Copie o conte√∫do do arquivo SQL
6. Cole no editor
7. Clique em **Run** (ou Ctrl+Enter)
8. Repita para cada arquivo SQL

**ORDEM DE APLICA√á√ÉO:**
1. Primeiro: `20251222000001_live_chat_system.sql`
2. Segundo: `20251222000002_performance_indexes.sql`
3. Terceiro: `20251222200000_security_fortress_ultra.sql`
4. Quarto: `20251222400000_sna_omega_complete.sql`

### PASSO 2: Deploy das Edge Functions
**OP√á√ÉO A - Via CLI (se tiver instalado):**
```bash
supabase functions deploy secure-webhook-ultra
supabase functions deploy sna-gateway
supabase functions deploy sna-worker
```

**OP√á√ÉO B - Via Dashboard:**
1. V√° em **Edge Functions** no Supabase Dashboard
2. Clique em **New Function**
3. Cole o c√≥digo do arquivo `index.ts` de cada pasta
4. Salve e fa√ßa deploy

### PASSO 3: Configurar Cron do Worker
1. V√° em **SQL Editor** no Supabase
2. Execute:
```sql
SELECT cron.schedule(
  'sna-worker-cron',
  '* * * * *',
  $$SELECT net.http_post(
    url := 'https://fyikfsasudgzsjmumdlw.supabase.co/functions/v1/sna-worker',
    headers := '{"Authorization": "Bearer <SERVICE_ROLE_KEY>"}'::jsonb,
    body := '{}'::jsonb
  );$$
);
```

### PASSO 4: Testar
1. Acesse o sistema normalmente
2. V√° em Admin > Central de IAs
3. Clique em "Healthcheck" para testar as IAs

---

## üìç MAPA DE URLs DEFINITIVO (REGRA INVIOL√ÅVEL)

| Quem | URL | Role | Valida√ß√£o |
|------|-----|------|-----------|
| üåê N√ÉO PAGANTE | pro.moisesmedeiros.com.br/ | NULL, viewer, aluno_gratuito | Criar conta = acesso livre |
| üë®‚Äçüéì ALUNO BETA | pro.moisesmedeiros.com.br/alunos | beta | role='beta' + acesso v√°lido |
| üëî FUNCION√ÅRIO | gestao.moisesmedeiros.com.br/ | funcionario | role='funcionario' |
| üëë OWNER | TODAS | owner | role='owner' |

---

## üì¶ MATRIZES IMPLEMENTADAS

| Matriz | Status | Arquivos |
|--------|--------|----------|
| üèéÔ∏è PERFORMANCE | ‚úÖ Completa | Chat, √≠ndices, cache |
| üõ°Ô∏è SEGURAN√áA | ‚úÖ Completa | RLS, sess√µes, 2FA |
| üß† AUTOMA√á√ÉO IA | ‚úÖ Completa | SNA Gateway, Worker, 18 workflows |

---

*Documento mantido pelo sistema SYNAPSE v15.0*
*√öltima atualiza√ß√£o: 22/12/2025 pelo MESTRE*
